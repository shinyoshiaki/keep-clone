(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5498:function(e,t,n){e.exports=n(5749)},5749:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),c=n(7),i=n(0),o=n.n(i),u=n(24),l=n.n(u),s=n(23),d=n(19),f={posts:[]},p=function(e){return{type:"MAIN_POST",payload:e}},m=function(e){return{type:"MAIN_REMOVE",payload:e}};var g=n(37),v=n(6),h=n(31),b=n.n(h),y=n(21),E=function(e){var t=e.label;return o.a.createElement("div",{style:{borderRadius:10,backgroundColor:"#EBEBEB",padding:5,paddingLeft:10,paddingRight:10,margin:5,display:"inline-block",fontSize:11}},t)},x=n(93),w=function(e){var t=e.onChange,n=e.label,a=e.style;return o.a.createElement("div",{style:a},o.a.createElement(v.c,{onChange:function(e,n){t(n)}}),n)},k=function(e){var t=e.tagList,n=e.selected,a=e.unSelected,r=b()({tagList:[],newTag:""}),c=r.state,u=r.setState;return Object(i.useEffect)(function(){u(function(e){return{tagList:Array.from(new Set([].concat(Object(x.a)(t),Object(x.a)(e.tagList))))}})},[t]),o.a.createElement("div",null,o.a.createElement(v.f,{placeholder:"input label",onChange:function(e){return u({newTag:e.target.value})},value:c.newTag,onKeyPress:function(e){"Enter"===e.key&&u(function(e){return{tagList:Array.from(new Set([e.newTag].concat(Object(x.a)(e.tagList)))),newTag:""}})},style:{padding:10}}),o.a.createElement("div",{style:{display:"flex"}},c.tagList.map(function(e){return o.a.createElement(w,{label:e,onChange:function(t){t?n(e):a&&a(e)},key:e})})))},j={title:"",text:"",tag:[],editLabel:!1},O=function(e){var t=e.onEdited,n=e.menus,a=e.initial,r=e.allTag,c=e.onClose,u=b()(j),l=u.state,s=u.setState;return Object(i.useEffect)(function(){if(console.log({initial:a}),a){var e=a.title,t=a.text,n=a.tag;s({title:e,text:t,tag:n})}},[a]),o.a.createElement("div",{style:{borderRadius:5,boxShadow:"0 0 4px gray",display:"grid",gridTemplateColumns:"1.6fr 0.2fr",gridTemplateRows:"auto auto auto auto auto",gridTemplateAreas:'"title star" "text text" "tag tag" "menu close" "option option"'}},o.a.createElement("div",{style:{gridArea:"title"}},o.a.createElement(v.f,{placeholder:"title",style:{width:"100%",padding:10},onChange:function(e){return s({title:e.target.value})},value:l.title})),o.a.createElement("div",{style:{gridArea:"star",display:"flex",justifyContent:"flex-end"}},o.a.createElement(v.e,null,o.a.createElement(y.h,null))),o.a.createElement("div",{style:{gridArea:"text"}},o.a.createElement(v.f,{placeholder:"input",multiline:!0,rows:2,rowsMax:30,style:{width:"97%",padding:10,paddingBottom:20,overflowY:"auto"},onChange:function(e){return s({text:e.target.value})},value:l.text})),o.a.createElement("div",{style:{gridArea:"tag"}},l.tag.map(function(e){return o.a.createElement(E,{label:e,key:e})})),o.a.createElement("div",{style:{gridArea:"menu",display:"flex"}},o.a.createElement(v.e,{style:{width:50,height:50},onClick:function(){return s(function(e){return{editLabel:!e.editLabel}})}},o.a.createElement(y.e,null)),n&&n()),o.a.createElement("div",{style:{gridArea:"close"}},o.a.createElement(v.b,{onClick:function(){(l.text.length>0||l.title.length>0)&&(t(l),s(j)),c()}},"close")),o.a.createElement("div",{style:{gridArea:"option",display:"flex"}},l.editLabel&&o.a.createElement(k,{tagList:r,selected:function(e){return s(function(t){return{tag:t.tag.concat(e)}})},unSelected:function(e){return s(function(t){return{tag:t.tag.filter(function(t){if(t!==e)return t})}})}})))},C=function(e){var t=e.onSubmit,n=e.allTag,a=Object(i.useState)(!1),r=Object(g.a)(a,2),c=r[0],u=r[1];return o.a.createElement("div",null,c?o.a.createElement(O,{onEdited:function(e){var n=e.text,a=e.title,r=e.tag;(n.length>0||a.length>0)&&t(a,n,r),u(!1)},initial:{title:"",text:"",tag:[]},allTag:n,onClose:function(){return u(!1)}}):o.a.createElement("div",{style:{display:"flex",borderRadius:5,boxShadow:"0 0 4px gray"},onClick:function(){return u(!0)}},o.a.createElement(v.j,{style:{padding:10}},"\u30e1\u30e2\u3092\u5165\u529b...")))};function S(e){var t=Object(i.useState)(!1),n=Object(g.a)(t,2),a=n[0],o=n[1],u=Object(i.useState)(!1),l=Object(g.a)(u,2),s=l[0],d=l[1];return{loading:a,fetch:function(){var t=Object(c.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o(!0),!n){t.next=7;break}return t.next=4,e(n);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,e(void 0);case 9:t.t0=t.sent;case 10:return(a=t.t0)||d(!0),o(!1),t.abrupt("return",a);case 14:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),error:s}}var T=n(25),A=n(26),M=n.n(A),I=n(89),N=n(38),L=n(209),R=function e(){var t=this;Object(I.a)(this,e),this.httpLink=void 0,this.query=function(){var e=Object(c.a)(r.a.mark(function e(n){var a,c,i,o=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:{},c={query:n,variables:a},e.prev=2,e.next=5,Object(N.d)(Object(N.b)(t.httpLink,c));case 5:return i=e.sent,e.abrupt("return",i.data);case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),this.httpLink=new L.a({uri:"https://echosome.tk:1333/query"})};function W(){var e=Object(T.a)(['\n        mutation createMemo {\n          createMemo(\n            input: {\n              token: "','"\n              title: "','"\n              text: "','"\n              tag:',"\n            }\n          ) {\n            time\n            code\n          }\n        }\n      "]);return W=function(){return e},e}var _=new R;function q(){return(q=Object(c.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(JSON.stringify(t.tag)),e.next=3,_.query(M()(W(),t.token,t.title,t.text,JSON.stringify(t.tag))).catch();case 3:if(!(n=e.sent).createMemo){e.next=7;break}return a=n.createMemo,e.abrupt("return",{time:a.time,code:a.code});case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var U=function(e){return q.apply(this,arguments)},J=n(91),D=n.n(J),G=Object(s.b)(function(e){return Object(d.a)({},e.main,e.user)})(function(e){var t=e.dispatch,n=e.posts,a=e.session,i=S(U),u=i.loading,l=i.fetch,s=n.flatMap(function(e){return e.tag.length>0?e.tag:[]}),d=function(){var e=Object(c.a)(r.a.mark(function e(n,c,i){var o,s,d;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=9;break}if(o=D()(Date.now()).utc().unix().toString(),s=Math.random().toString(),!a){e.next=8;break}return e.next=6,l({title:n,text:c,token:a,tag:i}).catch();case 6:(d=e.sent)&&(o=d.time,s=d.code);case 8:t(p({title:n,text:c,tag:i,time:o,code:s}));case 9:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}();return o.a.createElement(C,{onSubmit:d,allTag:s})}),B=n(204),H=n.n(B),V=function(e){var t,n=e.card,a=e.onRemove,r=e.modal,c=b()({open:!1,modal:!1}),i=c.state,u=c.setState,l=n.title,s=n.text,d=n.tag;return o.a.createElement("div",null,r(i.modal,function(){return u({modal:!1})},n),o.a.createElement("div",{style:{borderRadius:5,boxShadow:"0 0 1px gray",padding:5,paddingLeft:20},onMouseEnter:function(){return u({open:!0})},onMouseLeave:function(){return u({open:!1})}},o.a.createElement("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"1.7fr 0.3fr",gridTemplateRows:"auto auto auto auto",gridTemplateAreas:'"title star" "text text" "tag tag" "menu menu"'}},o.a.createElement("div",{style:{gridArea:"title",overflow:"hidden"}},o.a.createElement("div",{style:{fontWeight:"bold",marginTop:10}},l)),o.a.createElement("div",{style:{gridArea:"text"},onClick:function(){u({modal:!0})}},o.a.createElement("div",{style:{wordWrap:"break-word"}},s)),o.a.createElement("div",{style:{gridArea:"star",display:"flex",justifyContent:"flex-end",height:50}},i.open&&o.a.createElement(v.e,{style:{width:50}},o.a.createElement(y.h,null))),d.length>0&&o.a.createElement("div",{style:{gridArea:"tag",paddingTop:10}},d.filter(function(e){return""!==e}).map(function(e){return o.a.createElement(E,{label:e,key:e})})),o.a.createElement("div",{style:{gridArea:"menu",display:"flex",justifyContent:"flex-end",marginTop:"auto",height:50}},o.a.createElement("div",{style:{display:(t=i.open,t?"":"none")}},o.a.createElement(v.e,{style:{width:50},onClick:function(){return a()}},o.a.createElement(y.b,null)),o.a.createElement(v.e,{style:{width:50}},o.a.createElement(y.e,null)),o.a.createElement(v.e,{style:{width:50}},o.a.createElement(y.f,null)))))))},P=function(e){var t=e.open,n=e.initial,a=e.onEdited,r=e.allTag,c=e.menus,i=e.onClose;return o.a.createElement(v.g,{open:t},o.a.createElement("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},o.a.createElement("div",{style:{width:600,maxWidth:"90vw",backgroundColor:"white"}},o.a.createElement(O,{onEdited:a,initial:n,allTag:r,menus:c,onClose:i}))))},Y=function(e){var t=e.posts,n=e.searchWord,a=e.viewTag,r=e.onRemove,c=e.onChange,i=t.flatMap(function(e){return e.tag.length>0?e.tag:[]});return o.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},o.a.createElement(H.a,{options:{fitWidth:!0,columnWidth:350}},t.sort(function(e,t){return Number(e.time)-Number(t.time)}).reverse().map(function(e,t){if(function(e){return n.length>0&&(e.text.includes(n)||e.title.includes(n))?(console.log(1,n),!0):a&&e.tag.includes(a)?(console.log(2),!0):!(n.length>0||a)&&(console.log(3),!0)}(e))return o.a.createElement("div",{style:{width:350,maxWidth:"90vw"},key:t},o.a.createElement("div",{style:{padding:10}},o.a.createElement(V,{card:e,onRemove:function(){return r(e.code)},modal:function(e,t,n){var a=n.title,u=n.text,l=n.tag,s=n.code,d=D()(Date.now()).utc().unix().toString();return o.a.createElement(P,{open:e,onEdited:function(e){var n=e.title,a=e.text,r=e.tag;c({code:s,time:d,title:n,text:a,tag:r}),t()},onClose:function(){return t()},initial:{title:a,text:u,tag:l},allTag:i,menus:function(){return o.a.createElement("div",null,o.a.createElement(v.e,{onClick:function(){r(n.code),t()}},o.a.createElement(y.b,null)))}})}})))})))};function z(){var e=Object(T.a)(['\n        mutation EditMemo {\n          editMemo(\n            input: {\n              token: "','"\n              memoCode: "','"\n              title: "','"\n              text: "','"\n              tag: ',"\n            }\n          ) {\n            time\n          }\n        }\n      "]);return z=function(){return e},e}var K=new R;function X(){return(X=Object(c.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(JSON.stringify(t.tag)),e.next=3,K.query(M()(z(),t.token,t.memoCode,t.title,t.text,JSON.stringify(t.tag))).catch();case 3:if(!(n=e.sent)||!n.editMemo){e.next=7;break}return a=n.editMemo,e.abrupt("return",{time:a.time});case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $=function(e){return X.apply(this,arguments)};function F(){var e=Object(T.a)(['\n        mutation RemoveMemo {\n          removeMemo(\n            input: {\n              token: "','"\n              memoCode: "','"\n            }\n          ) {\n            code\n          }\n        }\n      ']);return F=function(){return e},e}var Q=new R;function Z(){return(Z=Object(c.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.query(M()(F(),t.token,t.memoCode)).catch();case 2:if(n=e.sent,console.log({result:n}),!n||!n.removeMemo){e.next=7;break}return a=n.removeMemo,e.abrupt("return",{code:a.code});case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ee,te=function(e){return Z.apply(this,arguments)},ne=Object(s.b)(function(e){return Object(d.a)({},e.main,e.ui,e.user)})(function(e){var t=e.posts,n=e.dispatch,a=e.viewTag,i=e.searchWord,u=e.session,l=S($),s=function(){var e=Object(c.a)(r.a.mark(function e(t){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=6;break}if(l.loading){e.next=6;break}return e.next=4,l.fetch(Object(d.a)({memoCode:t.code,token:u},t)).catch();case 4:(a=e.sent)&&(t.time=a.time);case 6:n({type:"MAIN_CHANGE",payload:t});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),f=S(te),p=function(){var e=Object(c.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!u||f.loading){e.next=5;break}return e.next=3,f.fetch({memoCode:t,token:u}).catch();case 3:e.sent||console.log("network issue");case 5:n(m(t));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(Y,{posts:t,searchWord:i,viewTag:a,onRemove:p,onChange:s})}),ae=function(e){var t=e.onSubmit,n=b()({input:""}),a=n.state,r=n.setState;return o.a.createElement("div",{style:{marginLeft:20,borderRadius:5,backgroundColor:"rgba(255,255,255,0.25)",marginRight:10,width:"100%",display:"flex"}},o.a.createElement("div",{style:{padding:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},o.a.createElement(y.g,null)),o.a.createElement(v.f,{placeholder:"Search\u2026",style:{color:"inherit",width:"100%",padding:5,paddingLeft:10},onChange:function(e){r({input:e.target.value}),t(e.target.value)},value:a.input}),a.input.length>0&&o.a.createElement(v.e,{onClick:function(){r({input:""}),t("")}},o.a.createElement(y.a,null)))},re=function(e){var t=e.drawer,n=e.enterSearch,a=e.account,r=b()({open:!1}),c=r.state,i=r.setState;return o.a.createElement("div",null,o.a.createElement(v.a,{position:"static"},o.a.createElement(v.i,null,o.a.createElement(v.e,{color:"inherit",onClick:function(){return i({open:!0})}},o.a.createElement(y.d,null)),o.a.createElement(v.j,{variant:"h6",color:"inherit"},"keep"),o.a.createElement(ae,{onSubmit:n}),o.a.createElement("div",null,a()))),o.a.createElement(v.d,{open:c.open,onClose:function(){return i({open:!1})}},t(function(){return i({open:!1})})))},ce=function(e){var t=e.label,n=e.onClick;return o.a.createElement("li",{style:{display:"flex",padding:10},onClick:function(){return n(t)}},o.a.createElement(y.c,{style:{paddingRight:30,color:"gray"}}),t)},ie=function(e){var t=e.labels,n=e.onClick,a=e.resetAll;return o.a.createElement("div",{style:{width:270}},o.a.createElement(v.j,{style:{padding:10}},"label"),o.a.createElement(ce,{label:"all",onClick:function(){return a()}}),t.filter(function(e){return""!==e}).map(function(e,t){return o.a.createElement(ce,{label:e,onClick:n,key:t})}))},oe={viewTag:"",searchWord:""};!function(e){e.SET_VIEWTAG="UI_SET_VIEWTAG",e.SET_SEARCH="UI_SET_SEARCH"}(ee||(ee={}));var ue=function(){var e=Object(c.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:ee.SET_VIEWTAG,payload:t});case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),le=function(){var e=Object(c.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:ee.SET_SEARCH,payload:t});case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}();var se=n(5753),de=Object(se.a)(Object(s.b)(function(e){return Object(d.a)({},e.main,e.user)})(function(e){var t=e.children,n=e.posts,a=e.dispatch,r=e.history,c=e.name,i=Array.from(new Set(n.flatMap(function(e){return e.tag.length>0?e.tag:[]})));return console.log({allTag:i}),o.a.createElement("div",{style:{minHeight:"95vh"}},o.a.createElement(re,{enterSearch:function(e){le(e,a)},drawer:function(e){return o.a.createElement(ie,{labels:i,onClick:function(t){ue(t,a),e()},resetAll:function(){ue(void 0,a),e()}})},account:function(){return c?o.a.createElement(v.b,{color:"inherit",onClick:function(){console.log({history:r}),r.push("login")}},c):o.a.createElement(v.b,{color:"inherit",onClick:function(){console.log({history:r}),r.push("login")}},"login")}}),t)})),fe=function(){return o.a.createElement(de,null,o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},o.a.createElement("div",{style:{padding:30,width:600,maxWidth:"90vw"}},o.a.createElement(G,null))),o.a.createElement(ne,null))};function pe(){var e=Object(T.a)(['\n        query getAllMemo {\n          getAllMemo(\n            input: { token: "','" }\n          ) {\n            memos {\n              owner\n              code\n              title\n              time\n              text\n              tag\n            }\n          }\n        }\n      ']);return pe=function(){return e},e}var me=new R;function ge(){return(ge=Object(c.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.query(M()(pe(),t.token)).catch();case 2:if(!(n=e.sent).getAllMemo){e.next=6;break}return a=n.getAllMemo,e.abrupt("return",a.memos?a.memos.map(function(e){return e.tag=e.tag.split(","),e}):void 0);case 6:return e.abrupt("return",void 0);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ve=function(e){return ge.apply(this,arguments)},he=Object(s.b)(function(e){return Object(d.a)({},e.main,e.user)})(function(e){var t=e.posts,n=e.session,a=e.dispatch,u=S(ve),l=u.loading,s=u.fetch;Object(i.useEffect)(function(){m()},[]);var f=function(){var e=Object(c.a)(r.a.mark(function e(a){var c,i,o,u,l,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c=!0,i=!1,o=void 0,e.prev=3,u=r.a.mark(function e(){var t,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.value,c=a.find(function(e){return t.code===e.code})){e.next=7;break}return e.next=5,U(Object(d.a)({token:n},t));case 5:e.next=10;break;case 7:if(!(Number(t.time)>Number(c.time))){e.next=10;break}return e.next=10,U(Object(d.a)({token:n},t));case 10:case"end":return e.stop()}},e)}),l=t[Symbol.iterator]();case 6:if(c=(s=l.next()).done){e.next=11;break}return e.delegateYield(u(),"t0",8);case 8:c=!0,e.next=6;break;case 11:e.next=17;break;case 13:e.prev=13,e.t1=e.catch(3),i=!0,o=e.t1;case 17:e.prev=17,e.prev=18,c||null==l.return||l.return();case 20:if(e.prev=20,!i){e.next=23;break}throw o;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}},e,null,[[3,13,17,25],[18,,20,24]])}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(c.a)(r.a.mark(function e(){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}if(l){e.next=6;break}return e.next=4,s({token:n}).catch();case 4:(c=e.sent)&&(f(c),c.forEach(function(e){t.find(function(t){return t.code===e.code})||a(p(e))}));case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return o.a.createElement(fe,null)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var be=n(5755),ye=n(5754),Ee=n(53),xe=n(208),we=n.n(xe),ke={},je=function(e,t,n){return{type:"UI_LOGIN",payload:{name:e,session:t,code:n}}};var Oe=n(45),Ce=n.n(Oe);Ce.a.config({driver:Ce.a.INDEXEDDB});var Se={},Te=function(){return function(e){var t=e.getState;return function(e){return function(){var n=Object(c.a)(r.a.mark(function n(a){var c,i,o,u;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:c=e(a),i=Object.keys(t()),o=0;case 3:if(!(o<i.length)){n.next=11;break}return u=i[o],Se[u]=!0,n.next=8,Ce.a.setItem(u,JSON.stringify(t()[u]));case 8:o++,n.next=3;break;case 11:return n.next=13,Ce.a.setItem("root",JSON.stringify(Se));case 13:return n.abrupt("return",c);case 14:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}}},Ae=function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,i,o,u,l,s=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},e.prev=1,e.next=4,Ce.a.getItem("root");case 4:a=e.sent,console.log({root:a}),c=Object.keys(JSON.parse(a)),i=0;case 8:if(!(i<c.length)){e.next=25;break}return o=c[i],console.log({key:o}),e.prev=11,u=t.getState()[o],e.next=15,Ce.a.getItem(o);case 15:l=e.sent,console.log({value:l}),n.whitelist?n.whitelist.includes(o)&&(t.getState()[o]=Object(d.a)({},u,JSON.parse(l))):t.getState()[o]=Object(d.a)({},u,JSON.parse(l)),e.next=22;break;case 20:e.prev=20,e.t0=e.catch(11);case 22:i++,e.next=8;break;case 25:e.next=29;break;case 27:e.prev=27,e.t1=e.catch(1);case 29:case"end":return e.stop()}},e,null,[[1,27],[11,20]])}));return function(t){return e.apply(this,arguments)}}(),Me=Object(Ee.c)({main:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAIN_POST":return t.payload.tag=t.payload.tag.filter(function(e){return""!==e}),Object(d.a)({},e,{posts:e.posts.concat(t.payload)});case"MAIN_REMOVE":return Object(d.a)({},e,{posts:e.posts.filter(function(e){if(e.code!==t.payload)return e})});case"MAIN_CHANGE":var n=e.posts.map(function(e){return e.code===t.payload.code?t.payload:e});return Object(d.a)({},e,{posts:n});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee.SET_VIEWTAG:return Object(d.a)({},e,{viewTag:t.payload});case ee.SET_SEARCH:return Object(d.a)({},e,{searchWord:t.payload});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UI_LOGIN":return Object(d.a)({},e,t.payload);default:return e}}});var Ie=function(e){var t=e.type,n=e.onSubmit,a=Object(i.useState)(""),r=Object(g.a)(a,2),c=r[0],u=r[1],l=Object(i.useState)(""),s=Object(g.a)(l,2),d=s[0],f=s[1];return o.a.createElement("div",{style:{borderRadius:5,boxShadow:"0 0 1px gray",display:"flex",justifyContent:"center",padding:30}},o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column",height:210,width:500}},o.a.createElement(v.j,null,t),o.a.createElement(v.h,{variant:"outlined",placeholder:"name",label:"name",onChange:function(e){return u(e.target.value)},value:c}),o.a.createElement(v.h,{variant:"outlined",placeholder:"password",label:"password",onChange:function(e){return f(e.target.value)},value:d}),o.a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse"}},o.a.createElement(v.b,{onClick:function(){c&&d&&(n(c,d),u(""),f(""))}},t))))};function Ne(){var e=Object(T.a)(['\n          query getUser {\n            getUser(input: { name: "','", password: "','" }) {\n              token\n              code\n              name\n            }\n          }\n        ']);return Ne=function(){return e},e}var Le=function e(){var t=this;Object(I.a)(this,e),this.graphqlClient=new R,this.getMe=function(){var e=Object(c.a)(r.a.mark(function e(n){var a,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.graphqlClient.query(M()(Ne(),n.name,n.password));case 3:a=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(!a.getUser){e.next=12;break}return c=a.getUser,e.abrupt("return",{token:c.token,code:c.code,name:c.name});case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()},Re=Object(se.a)(Object(s.b)(function(){return{}})(function(e){var t=e.history,n=e.dispatch,a=S((new Le).getMe),i=a.loading,u=a.fetch,l=a.error;return o.a.createElement("div",null,l&&o.a.createElement("p",null,"error"),o.a.createElement(Ie,{type:"login",onSubmit:function(){var e=Object(c.a)(r.a.mark(function e(a,c){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=5;break}return e.next=3,u({name:a,password:c});case 3:(o=e.sent)&&(console.log("success",{res:o}),n(je(o.name,o.token,o.code)),t.push("/"));case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}))})),We=Object(se.a)(function(e){var t=e.history;return o.a.createElement("div",{style:{height:"95vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},o.a.createElement("div",{style:{maxWidth:"90%"}},o.a.createElement(Re,null),o.a.createElement(v.b,{onClick:function(){return t.push("/signup")}},"sign up")))}),_e=n(205);function qe(){var e=Object(T.a)(['\n        mutation createUser {\n          createUser(input: { name: "','", password: "','" }) {\n            code\n            token\n            name\n          }\n        }\n      ']);return qe=function(){return e},e}var Ue=new R,Je=function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ue.query(M()(qe(),t.name,t.password));case 3:n=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(!n||!n.createUser){e.next=12;break}return a=n.createUser,e.abrupt("return",{token:a.token,code:a.code,name:a.name});case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),De=Object(_e.a)(Object(s.b)(function(){return{}})(function(e){var t=e.dispatch,n=e.history,a=S(Je),i=a.loading,u=a.fetch,l=a.error;return o.a.createElement("div",null,l&&o.a.createElement("p",null,"error"),o.a.createElement(Ie,{type:"signup",onSubmit:function(){var e=Object(c.a)(r.a.mark(function e(a,c){var o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=5;break}return e.next=3,u({name:a,password:c});case 3:(o=e.sent)&&(console.log("success",{res:o}),t(je(o.name,o.token,o.code)),n.push("/"));case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}))})),Ge=Object(se.a)(function(e){var t=e.history;return o.a.createElement("div",{style:{height:"95vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},o.a.createElement("div",{style:{maxWidth:"90%"}},o.a.createElement(De,null),o.a.createElement(v.b,{onClick:function(){return t.push("/login")}},"login")))}),Be={store:Object(Ee.d)(Me,Object(Ee.a)(we.a,Te()))}.store;function He(){return(He=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Be);case 2:l.a.render(o.a.createElement(s.a,{store:Be},o.a.createElement(be.a,null,o.a.createElement("div",null,o.a.createElement(ye.a,{exact:!0,path:"/",component:he}),o.a.createElement(ye.a,{path:"/login",component:We}),o.a.createElement(ye.a,{path:"/signup",component:Ge})))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){He.apply(this,arguments)}()}},[[5498,1,2]]]);
//# sourceMappingURL=main.578ab157.chunk.js.map