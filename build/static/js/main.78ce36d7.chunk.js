(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5497:function(e,t,n){e.exports=n(5749)},5749:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),i=n(7),o=n(0),c=n.n(o),u=n(25),l=n.n(u),s=n(23),d=n(19),f={posts:[]},p=function(e){return{type:"MAIN_POST",payload:e}},m=function(e){return{type:"MAIN_REMOVE",payload:e}};var h=n(36),g=n(6),v=n(31),y=n.n(v),b=n(22),E=function(e){var t=e.label;return c.a.createElement("div",{style:{borderRadius:10,backgroundColor:"#EBEBEB",padding:5,paddingLeft:10,paddingRight:10,margin:5,display:"inline-block",fontSize:11}},t)},x=n(91),w=function(e){var t=e.onChange,n=e.label,r=e.style;return c.a.createElement("div",{style:r},c.a.createElement(g.c,{onChange:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,n){t(n)})}),n)},k=function(e){var t=e.tagList,n=e.selected,r=e.unSelected,a=y()({tagList:[],newTag:""}),i=a.state,u=a.setState;return Object(o.useEffect)(function(){u(function(e){return{tagList:Array.from(new Set([].concat(Object(x.a)(t),Object(x.a)(e.tagList))))}})},[t]),c.a.createElement("div",null,c.a.createElement(g.f,{placeholder:"input label",onChange:function(e){return u({newTag:e.target.value})},value:i.newTag,onKeyPress:function(e){"Enter"===e.key&&u(function(e){return{tagList:Array.from(new Set([e.newTag].concat(Object(x.a)(e.tagList)))),newTag:""}})},style:{padding:10}}),c.a.createElement("div",{style:{display:"flex"}},i.tagList.map(function(e){return c.a.createElement(w,{label:e,onChange:function(t){t?n(e):r&&r(e)},key:e})})))},j={title:"",text:"",tag:[],editLabel:!1},O=function(e){var t=e.onEdited,n=e.menus,r=e.initial,a=e.allTag,i=e.onClose,u=y()(j),l=u.state,s=u.setState;return Object(o.useEffect)(function(){if(console.log({initial:r}),r){var e=r.title,t=r.text,n=r.tag;s({title:e,text:t,tag:n})}},[r]),c.a.createElement("div",{style:{borderRadius:5,boxShadow:"0 0 4px gray",display:"grid",gridTemplateColumns:"1.6fr 0.2fr",gridTemplateRows:"auto auto auto auto auto",gridTemplateAreas:'"title star" "text text" "tag tag" "menu close" "option option"'}},c.a.createElement("div",{style:{gridArea:"title"}},c.a.createElement(g.f,{placeholder:"title",style:{width:"100%",padding:10},onChange:function(e){return s({title:e.target.value})},value:l.title})),c.a.createElement("div",{style:{gridArea:"star",display:"flex",justifyContent:"flex-end"}},c.a.createElement(g.e,null,c.a.createElement(b.h,null))),c.a.createElement("div",{style:{gridArea:"text"}},c.a.createElement(g.f,{placeholder:"input",multiline:!0,rows:2,rowsMax:30,style:{width:"97%",padding:10,paddingBottom:20,overflowY:"auto"},onChange:function(e){return s({text:e.target.value})},value:l.text})),c.a.createElement("div",{style:{gridArea:"tag"}},l.tag.map(function(e){return c.a.createElement(E,{label:e,key:e})})),c.a.createElement("div",{style:{gridArea:"menu",display:"flex"}},c.a.createElement(g.e,{style:{width:50,height:50},onClick:function(){return s(function(e){return{editLabel:!e.editLabel}})}},c.a.createElement(b.e,null)),n&&n()),c.a.createElement("div",{style:{gridArea:"close"}},c.a.createElement(g.b,{onClick:function(){(l.text.length>0||l.title.length>0)&&(t(l),s(j)),i()}},"close")),c.a.createElement("div",{style:{gridArea:"option",display:"flex"}},l.editLabel&&c.a.createElement(k,{tagList:a,selected:function(e){return s(function(t){return{tag:t.tag.concat(e)}})},unSelected:function(e){return s(function(t){return{tag:t.tag.filter(function(t){if(t!==e)return t})}})}})))},C=function(e){var t=e.onSubmit,n=e.allTag,r=Object(o.useState)(!1),a=Object(h.a)(r,2),i=a[0],u=a[1];return c.a.createElement("div",null,i?c.a.createElement(O,{onEdited:function(e){var n=e.text,r=e.title,a=e.tag;(n.length>0||r.length>0)&&t(r,n,a),u(!1)},initial:{title:"",text:"",tag:[]},allTag:n,onClose:function(){return u(!1)}}):c.a.createElement("div",{style:{display:"flex",borderRadius:5,boxShadow:"0 0 4px gray"},onClick:function(){return u(!0)}},c.a.createElement(g.j,{style:{padding:10}},"\u30e1\u30e2\u3092\u5165\u529b...")))};function S(e){var t=Object(o.useState)(!1),n=Object(h.a)(t,2),r=n[0],c=n[1],u=Object(o.useState)(!1),l=Object(h.a)(u,2),s=l[0],d=l[1];return{loading:r,fetch:function(){var t=Object(i.a)(a.a.mark(function t(n){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(c(!0),!n){t.next=7;break}return t.next=4,e(n);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,e(void 0);case 9:t.t0=t.sent;case 10:return(r=t.t0)||d(!0),c(!1),t.abrupt("return",r);case 14:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),error:s}}var T=n(26),A=n(27),M=n.n(A),I=n(88),L=n(37),R=n(208),W=function e(){var t=this;Object(I.a)(this,e),this.httpLink=void 0,this.query=function(){var e=Object(i.a)(a.a.mark(function e(n){var r,i,o,c=arguments;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:{},i={query:n,variables:r},e.prev=2,e.next=5,Object(L.d)(Object(L.b)(t.httpLink,i));case 5:return o=e.sent,e.abrupt("return",o.data);case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),this.httpLink=new R.a({uri:"https://echosome.tk:1333/query"})};function N(){var e=Object(T.a)(['\n        mutation createMemo {\n          createMemo(\n            input: {\n              token: "','"\n              title: "','"\n              text: "','"\n              tag:',"\n            }\n          ) {\n            time\n            code\n          }\n        }\n      "]);return N=function(){return e},e}var _=new W;function q(){return(q=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(JSON.stringify(t.tag)),e.next=3,_.query(M()(N(),t.token,t.title,t.text,JSON.stringify(t.tag))).catch();case 3:if(!(n=e.sent).createMemo){e.next=7;break}return r=n.createMemo,e.abrupt("return",{time:r.time,code:r.code});case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var U=function(e){return q.apply(this,arguments)},D=n(203),G=n.n(D),J=Object(s.b)(function(e){return Object(d.a)({},e.main,e.user)})(function(e){var t=e.dispatch,n=e.posts,r=e.session,o=S(U),u=o.loading,l=o.fetch,s=(o.error,n.flatMap(function(e){return e.tag.length>0?e.tag:[]})),d=function(){var e=Object(i.a)(a.a.mark(function e(n,i,o){var c,s,d;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=9;break}if(c=G()(Date.now()).utc().unix().toString(),s=Math.random().toString(),!r){e.next=8;break}return e.next=6,l({title:n,text:i,token:r,tag:o});case 6:(d=e.sent)&&(c=d.time,s=d.code);case 8:t(p({title:n,text:i,tag:o,time:c,code:s}));case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}();return c.a.createElement(C,{onSubmit:d,allTag:s})}),B=n(204),H=n.n(B),V=function(e){var t,n=e.card,r=e.onRemove,a=e.modal,i=y()({open:!1,modal:!1}),o=i.state,u=i.setState,l=n.title,s=n.text,d=n.tag;return c.a.createElement("div",null,a(o.modal,function(){return u({modal:!1})},n),c.a.createElement("div",{style:{borderRadius:5,boxShadow:"0 0 1px gray",padding:5,paddingLeft:20},onMouseEnter:function(){return u({open:!0})},onMouseLeave:function(){return u({open:!1})}},c.a.createElement("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"1.7fr 0.3fr",gridTemplateRows:"auto auto auto auto",gridTemplateAreas:'"title star" "text text" "tag tag" "menu menu"'}},c.a.createElement("div",{style:{gridArea:"title",overflow:"hidden"}},c.a.createElement("div",{style:{fontWeight:"bold",marginTop:10}},l)),c.a.createElement("div",{style:{gridArea:"text"},onClick:function(){u({modal:!0})}},c.a.createElement("div",{style:{wordWrap:"break-word"}},s)),c.a.createElement("div",{style:{gridArea:"star",display:"flex",justifyContent:"flex-end",height:50}},o.open&&c.a.createElement(g.e,{style:{width:50}},c.a.createElement(b.h,null))),d.length>0&&c.a.createElement("div",{style:{gridArea:"tag",paddingTop:10}},d.filter(function(e){return""!==e}).map(function(e){return c.a.createElement(E,{label:e,key:e})})),c.a.createElement("div",{style:{gridArea:"menu",display:"flex",justifyContent:"flex-end",marginTop:"auto",height:50}},c.a.createElement("div",{style:{display:(t=o.open,t?"":"none")}},c.a.createElement(g.e,{style:{width:50},onClick:function(){return r()}},c.a.createElement(b.b,null)),c.a.createElement(g.e,{style:{width:50}},c.a.createElement(b.e,null)),c.a.createElement(g.e,{style:{width:50}},c.a.createElement(b.f,null)))))))},P=function(e){var t=e.open,n=e.initial,r=e.onEdited,a=e.allTag,i=e.menus,o=e.onClose;return c.a.createElement(g.g,{open:t},c.a.createElement("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement("div",{style:{width:600,maxWidth:"90vw",backgroundColor:"white"}},c.a.createElement(O,{onEdited:r,initial:n,allTag:a,menus:i,onClose:o}))))},Y=function(e){var t=e.posts,n=e.searchWord,r=e.viewTag,a=e.onRemove,i=e.onChange,o=t.flatMap(function(e){return e.tag.length>0?e.tag:[]});return c.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},c.a.createElement(H.a,{options:{fitWidth:!0,columnWidth:350}},t.map(function(e,t){if(function(e){return n.length>0&&(e.text.includes(n)||e.title.includes(n))?(console.log(1,n),!0):r&&e.tag.includes(r)?(console.log(2),!0):!(n.length>0||r)&&(console.log(3),!0)}(e))return c.a.createElement("div",{style:{width:350,maxWidth:"90vw"},key:t},c.a.createElement("div",{style:{padding:10}},c.a.createElement(V,{card:e,onRemove:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return a(e.code)}),modal:function(e,t,n){var r=n.title,u=n.text,l=n.time,s=n.tag,d=n.code;return c.a.createElement(P,{open:e,onEdited:function(e){var n=e.title,r=e.text,a=e.tag;i({code:d,time:l,title:n,text:r,tag:a}),t()},onClose:function(){return t()},initial:{title:r,text:u,tag:s},allTag:o,menus:function(){return c.a.createElement("div",null,c.a.createElement(g.e,{onClick:function(){a(n.code),t()}},c.a.createElement(b.b,null)))}})}})))})))};function z(){var e=Object(T.a)(['\n        mutation EditMemo {\n          editMemo(\n            input: {\n              token: "','"\n              memoCode: "','"\n              title: "','"\n              text: "','"\n              tag: ',"\n            }\n          ) {\n            time\n          }\n        }\n      "]);return z=function(){return e},e}var K=new W;function X(){return(X=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(JSON.stringify(t.tag)),e.next=3,K.query(M()(z(),t.token,t.memoCode,t.title,t.text,JSON.stringify(t.tag))).catch();case 3:if(!(n=e.sent)||!n.editMemo){e.next=7;break}return r=n.editMemo,e.abrupt("return",{time:r.time});case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var $=function(e){return X.apply(this,arguments)};function F(){var e=Object(T.a)(['\n        mutation RemoveMemo {\n          removeMemo(\n            input: {\n              token: "','"\n              memoCode: "','"\n            }\n          ) {\n            code\n          }\n        }\n      ']);return F=function(){return e},e}var Q=new W;function Z(){return(Z=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.query(M()(F(),t.token,t.memoCode)).catch();case 2:if(n=e.sent,console.log({result:n}),!n||!n.removeMemo){e.next=7;break}return r=n.removeMemo,e.abrupt("return",{code:r.code});case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var ee,te=function(e){return Z.apply(this,arguments)},ne=Object(s.b)(function(e){return Object(d.a)({},e.main,e.ui,e.user)})(function(e){var t=e.posts,n=e.dispatch,r=e.viewTag,o=e.searchWord,u=e.session,l=S($),s=function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=4;break}if(l.loading){e.next=4;break}return e.next=4,l.fetch(Object(d.a)({memoCode:t.code,token:u},t));case 4:n({type:"MAIN_CHANGE",payload:{post:t,newTime:void 0}});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=S(te),p=function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!u||f.loading){e.next=5;break}return e.next=3,f.fetch({memoCode:t,token:u}).catch();case 3:e.sent||console.log("network issue");case 5:n(m(t));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();return c.a.createElement(Y,{posts:t,searchWord:o,viewTag:r,onRemove:p,onChange:s})}),re=function(e){var t=e.onSubmit,n=y()({input:""}),r=n.state,a=n.setState;return c.a.createElement("div",{style:{marginLeft:20,borderRadius:5,backgroundColor:"rgba(255,255,255,0.25)",marginRight:10,width:"100%",display:"flex"}},c.a.createElement("div",{style:{padding:10,height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},c.a.createElement(b.g,null)),c.a.createElement(g.f,{placeholder:"Search\u2026",style:{color:"inherit",width:"100%",padding:5,paddingLeft:10},onChange:function(e){a({input:e.target.value}),t(e.target.value)},value:r.input}),r.input.length>0&&c.a.createElement(g.e,{onClick:function(){a({input:""}),t("")}},c.a.createElement(b.a,null)))},ae=function(e){var t=e.drawer,n=e.enterSearch,r=e.account,a=y()({open:!1}),i=a.state,o=a.setState;return c.a.createElement("div",null,c.a.createElement(g.a,{position:"static"},c.a.createElement(g.i,null,c.a.createElement(g.e,{color:"inherit",onClick:function(){return o({open:!0})}},c.a.createElement(b.d,null)),c.a.createElement(g.j,{variant:"h6",color:"inherit"},"keep"),c.a.createElement(re,{onSubmit:n}),c.a.createElement("div",null,r()))),c.a.createElement(g.d,{open:i.open,onClose:function(){return o({open:!1})}},t(function(){return o({open:!1})})))},ie=function(e){var t=e.label,n=e.onClick;return c.a.createElement("li",{style:{display:"flex",padding:10},onClick:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return n(t)})},c.a.createElement(b.c,{style:{paddingRight:30,color:"gray"}}),t)},oe=function(e){var t=e.labels,n=e.onClick,r=e.resetAll;return c.a.createElement("div",{style:{width:270}},c.a.createElement(g.j,{style:{padding:10}},"label"),c.a.createElement(ie,{label:"all",onClick:function(){return r()}}),t.filter(function(e){return""!==e}).map(function(e,t){return c.a.createElement(ie,{label:e,onClick:n,key:t})}))},ce={viewTag:"",searchWord:""};!function(e){e.SET_VIEWTAG="UI_SET_VIEWTAG",e.SET_SEARCH="UI_SET_SEARCH"}(ee||(ee={}));var ue=function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:ee.SET_VIEWTAG,payload:t});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),le=function(){var e=Object(i.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n({type:ee.SET_SEARCH,payload:t});case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}();var se=n(5752),de=Object(se.a)(Object(s.b)(function(e){return Object(d.a)({},e.main,e.user)})(function(e){var t=e.children,n=e.posts,r=e.dispatch,a=e.history,i=e.name,o=Array.from(new Set(n.flatMap(function(e){return e.tag.length>0?e.tag:[]})));return console.log({allTag:o}),c.a.createElement("div",{style:{minHeight:"95vh"}},c.a.createElement(ae,{enterSearch:function(e){le(e,r)},drawer:function(e){return c.a.createElement(oe,{labels:o,onClick:function(t){ue(t,r),e()},resetAll:function(){ue(void 0,r),e()}})},account:function(){return i?c.a.createElement(g.b,{color:"inherit",onClick:function(){console.log({history:a}),a.push("login")}},i):c.a.createElement(g.b,{color:"inherit",onClick:function(){console.log({history:a}),a.push("login")}},"login")}}),t)})),fe=function(){return c.a.createElement(de,null,c.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement("div",{style:{padding:30,width:600,maxWidth:"90vw"}},c.a.createElement(J,null))),c.a.createElement(ne,null))};function pe(){var e=Object(T.a)(['\n        query getAllMemo {\n          getAllMemo(\n            input: { token: "','" }\n          ) {\n            memos {\n              owner\n              code\n              title\n              time\n              text\n              tag\n            }\n          }\n        }\n      ']);return pe=function(){return e},e}var me=new W;function he(){return(he=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me.query(M()(pe(),t.token)).catch();case 2:if(!(n=e.sent).getAllMemo){e.next=6;break}return r=n.getAllMemo,e.abrupt("return",r.memos?r.memos.map(function(e){return e.tag=e.tag.split(","),e}):void 0);case 6:return e.abrupt("return",void 0);case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var ge=function(e){return he.apply(this,arguments)},ve=Object(s.b)(function(e){return Object(d.a)({},e.main,e.user)})(function(e){var t=e.posts,n=e.session,r=e.dispatch,u=S(ge),l=u.loading,s=u.fetch;Object(o.useEffect)(function(){m()},[]);var f=function(){var e=Object(i.a)(a.a.mark(function e(r){var i,o,c,u,l,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=!0,o=!1,c=void 0,e.prev=3,u=a.a.mark(function e(){var t,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.value,i=r.find(function(e){return t.code===e.code})){e.next=7;break}return e.next=5,U(Object(d.a)({token:n},t));case 5:e.next=10;break;case 7:if(!(Number(t.time)>Number(i.time))){e.next=10;break}return e.next=10,U(Object(d.a)({token:n},t));case 10:case"end":return e.stop()}},e,this)}),l=t[Symbol.iterator]();case 6:if(i=(s=l.next()).done){e.next=11;break}return e.delegateYield(u(),"t0",8);case 8:i=!0,e.next=6;break;case 11:e.next=17;break;case 13:e.prev=13,e.t1=e.catch(3),o=!0,c=e.t1;case 17:e.prev=17,e.prev=18,i||null==l.return||l.return();case 20:if(e.prev=20,!o){e.next=23;break}throw c;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}},e,this,[[3,13,17,25],[18,,20,24]])}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(a.a.mark(function e(){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=6;break}if(l){e.next=6;break}return e.next=4,s({token:n}).catch();case 4:(i=e.sent)&&(f(i),i.forEach(function(e){t.find(function(t){return t.code===e.code})||r(p(e))}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();return c.a.createElement(fe,null)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ye=n(5754),be=n(5753),Ee=n(53),xe=n(207),we=n.n(xe),ke={},je=function(e,t,n){return{type:"UI_LOGIN",payload:{name:e,session:t,code:n}}};var Oe=n(45),Ce=n.n(Oe);Ce.a.config({driver:Ce.a.INDEXEDDB});var Se={},Te=function(){return function(e){var t=e.getState;return function(e){return function(){var n=Object(i.a)(a.a.mark(function n(r){var i,o,c,u;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=e(r),o=Object.keys(t()),c=0;case 3:if(!(c<o.length)){n.next=11;break}return u=o[c],Se[u]=!0,n.next=8,Ce.a.setItem(u,JSON.stringify(t()[u]));case 8:c++,n.next=3;break;case 11:return n.next=13,Ce.a.setItem("root",JSON.stringify(Se));case 13:return n.abrupt("return",i);case 14:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}}},Ae=Object(Ee.c)({main:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAIN_POST":return t.payload.tag=t.payload.tag.filter(function(e){return""!==e}),Object(d.a)({},e,{posts:e.posts.concat(t.payload)});case"MAIN_REMOVE":return Object(d.a)({},e,{posts:e.posts.filter(function(e){if(e.code!==t.payload)return e})});case"MAIN_CHANGE":var n=e.posts.map(function(e){if(e.time===t.payload.post.time){var n=t.payload.post;return t.payload.newTime&&(n.time=t.payload.newTime),n.tag=n.tag.filter(function(e){return""!==e}),n}return e});return Object(d.a)({},e,{posts:n});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee.SET_VIEWTAG:return Object(d.a)({},e,{viewTag:t.payload});case ee.SET_SEARCH:return Object(d.a)({},e,{searchWord:t.payload});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UI_LOGIN":return Object(d.a)({},e,t.payload);default:return e}}});var Me=function(e){var t=e.type,n=e.onSubmit,r=Object(o.useState)(""),a=Object(h.a)(r,2),i=a[0],u=a[1],l=Object(o.useState)(""),s=Object(h.a)(l,2),d=s[0],f=s[1];return c.a.createElement("div",{style:{borderRadius:5,boxShadow:"0 0 1px gray",display:"flex",justifyContent:"center",padding:30}},c.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"column",height:210,width:500}},c.a.createElement(g.j,null,t),c.a.createElement(g.h,{variant:"outlined",placeholder:"name",label:"name",onChange:function(e){return u(e.target.value)},value:i}),c.a.createElement(g.h,{variant:"outlined",placeholder:"password",label:"password",onChange:function(e){return f(e.target.value)},value:d}),c.a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse"}},c.a.createElement(g.b,{onClick:function(){i&&d&&(n(i,d),u(""),f(""))}},t))))};function Ie(){var e=Object(T.a)(['\n          query getUser {\n            getUser(input: { name: "','", password: "','" }) {\n              token\n              code\n              name\n            }\n          }\n        ']);return Ie=function(){return e},e}var Le=function e(){var t=this;Object(I.a)(this,e),this.graphqlClient=new W,this.getMe=function(){var e=Object(i.a)(a.a.mark(function e(n){var r,i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.graphqlClient.query(M()(Ie(),n.name,n.password));case 3:r=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(!r.getUser){e.next=12;break}return i=r.getUser,e.abrupt("return",{token:i.token,code:i.code,name:i.name});case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()},Re=Object(se.a)(Object(s.b)(function(){return{}})(function(e){var t=e.history,n=e.dispatch,r=S((new Le).getMe),o=r.loading,u=r.fetch,l=r.error;return c.a.createElement("div",null,l&&c.a.createElement("p",null,"error"),c.a.createElement(Me,{type:"login",onSubmit:function(){var e=Object(i.a)(a.a.mark(function e(r,i){var c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=5;break}return e.next=3,u({name:r,password:i});case 3:(c=e.sent)&&(console.log("success",{res:c}),n(je(c.name,c.token,c.code)),t.push("/"));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}))})),We=Object(se.a)(function(e){var t=e.history;return c.a.createElement("div",{style:{height:"95vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},c.a.createElement("div",{style:{maxWidth:"90%"}},c.a.createElement(Re,null),c.a.createElement(g.b,{onClick:function(){return t.push("/signup")}},"sign up")))}),Ne=n(5747);function _e(){var e=Object(T.a)(['\n        mutation createUser {\n          createUser(input: { name: "','", password: "','" }) {\n            code\n            token\n            name\n          }\n        }\n      ']);return _e=function(){return e},e}var qe=new W,Ue=function(){var e=Object(i.a)(a.a.mark(function e(t){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,qe.query(M()(_e(),t.name,t.password));case 3:n=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:if(!n||!n.createUser){e.next=12;break}return r=n.createUser,e.abrupt("return",{token:r.token,code:r.code,name:r.name});case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),De=Object(Ne.a)(Object(s.b)(function(){return{}})(function(e){var t=e.dispatch,n=e.history,r=S(Ue),o=r.loading,u=r.fetch,l=r.error;return c.a.createElement("div",null,l&&c.a.createElement("p",null,"error"),c.a.createElement(Me,{type:"signup",onSubmit:function(){var e=Object(i.a)(a.a.mark(function e(r,i){var c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=5;break}return e.next=3,u({name:r,password:i});case 3:(c=e.sent)&&(console.log("success",{res:c}),t(je(c.name,c.token,c.code)),n.push("/"));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}))})),Ge=Object(se.a)(function(e){var t=e.history;return c.a.createElement("div",{style:{height:"95vh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},c.a.createElement("div",{style:{maxWidth:"90%"}},c.a.createElement(De,null),c.a.createElement(g.b,{onClick:function(){return t.push("/login")}},"login")))}),Je={store:Object(Ee.d)(Ae,Object(Ee.a)(we.a,Te()))}.store;function Be(){return(Be=Object(i.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l.a.render(c.a.createElement(s.a,{store:Je},c.a.createElement(ye.a,null,c.a.createElement("div",null,c.a.createElement(be.a,{exact:!0,path:"/",component:ve}),c.a.createElement(be.a,{path:"/login",component:We}),c.a.createElement(be.a,{path:"/signup",component:Ge})))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()});case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}!function(){Be.apply(this,arguments)}()}},[[5497,2,1]]]);
//# sourceMappingURL=main.78ce36d7.chunk.js.map